(function(){var e=document.getElementById("panel"),t=React.createClass({displayName:"MainPanel",changePage:function(e){this.setState({page:e})},system:function(e){$.ajax({url:"systemTask",dataType:"text",type:"POST",data:e,success:function(e){console.log("OK")}.bind(this),error:function(e,t,n){console.error("system",t,n.toString())}.bind(this)})},getInitialState:function(){var e="control";return{page:e}},render:function(){var e,t;return this.state.page=="control"?(t=React.createElement("button",{className:"configButton",type:"button",onClick:this.changePage.bind(this,"config")}),e=React.createElement(r,null)):this.state.page=="config"&&(t=React.createElement("div",null,React.createElement("button",{className:"applyButton",type:"button",onClick:this.changePage.bind(this,"control")}),React.createElement("button",{className:"shutdownButton",type:"button",onClick:this.system.bind(this,"shutdown")}),React.createElement("button",{className:"rebootButton",type:"button",onClick:this.system.bind(this,"reboot")})),e=React.createElement(n,null)),React.createElement("div",{className:"panel"},t,e)}}),n=React.createClass({displayName:"Config",checkStatus:function(){$.ajax({url:"getData",dataType:"json",cache:!1,success:function(e){var t=[],n=[],r;for(var i in e.zoneName)t.push(e.zoneName[i]);for(var i in e.zoneServer)n.push(e.zoneServer[i]);r=e.numOutputs,this.setState({zoneName:t}),this.setState({zoneServer:n}),this.setState({numZones:r})}.bind(this),error:function(e,t,n){console.error("getData",t,n.toString())}.bind(this)})},sendStatus:function(){var e=this.state.zoneName,t=this.state.zoneServer,n=this.state.numZones,r={outputs:{},servers:{}};for(var i=0;i<n;i++)r.outputs["out"+i]=e[i],r.servers["out"+i]=t[i];$.ajax({url:"sendNameData",dataType:"text",type:"POST",data:JSON.stringify(r),success:function(e){console.log("OK")}.bind(this),error:function(e,t,n){console.error("sendData",t,n.toString())}.bind(this)})},componentDidMount:function(){this.checkStatus()},componentWillUnmount:function(){this.sendStatus()},handleZoneName:function(e,t){var n=this.state.zoneName;n[e]=t.target.value,this.setState({zoneName:n})},handleZoneServer:function(e,t){var n=this.state.zoneServer;n[e]=t.target.value,this.setState({zoneServer:n})},getInitialState:function(){var e=[],t=[],n;return{zoneName:e,zoneServer:t,numZones:n}},render:function(){var e=[],t=this.state.zoneName,n=this.state.zoneServer,r=this.state.numZones,i;for(var s=0;s<r;s++)i=s+1,e.push(React.createElement("div",{className:"config",key:13*s},React.createElement("h1",null,i),React.createElement("input",{type:"text",value:t[s],onChange:this.handleZoneName.bind(this,s)}),React.createElement("input",{type:"text",value:n[s],onChange:this.handleZoneServer.bind(this,s)})));return React.createElement("div",null,e)}}),r=React.createClass({displayName:"Outputs",checkStatus:function(){$.ajax({url:"getData",dataType:"json",cache:!1,success:function(e){var t=[],n=[],r;for(var i in e.outputs)t.push(e.outputs[i]);for(var i in e.zoneName)n.push(e.zoneName[i]);r=e.numOutputs,this.setState({outs:t}),this.setState({zoneName:n}),this.setState({numZones:r})}.bind(this),error:function(e,t,n){console.error("getData",t,n.toString())}.bind(this)})},sendStatus:function(e,t){clearInterval(this.timer);var n={},r=[],i=this.state.numZones;n.state=e[t],n.out=t+1,$.ajax({url:"sendOutputData",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(e){for(var t=0;t<i;t++)r[t]=e.outputs["out"+t];this.setState({outs:r}),clearInterval(this.timer),this.timer=setInterval(this.tick,5e3)}.bind(this),error:function(e,t,n){console.error("sendData",t,n.toString())}.bind(this)})},componentDidMount:function(){this.checkStatus(),this.timer=setInterval(this.tick,5e3)},componentWillUnmount:function(){clearInterval(this.timer)},tick:function(){this.checkStatus()},enableOut:function(e){var t=this.state.outs;t[e]=1,this.setState({outs:t}),this.sendStatus(t,e)},disableOut:function(e){var t=this.state.outs;t[e]=0,this.setState({outs:t}),this.sendStatus(t,e)},getInitialState:function(){var e=[],t=[],n;for(var r=0;r<n;r++)t.push(0);return{outs:t,zoneName:e,numZones:n}},render:function(){var e=this.state.numZones,t=[],n,r,i,s;for(var o=0;o<e;o++)i=o+1,s=this.state.zoneName[o],this.state.outs[o]==0?(n="redCircle",r=React.createElement("button",{className:"enable",type:"button",onClick:this.enableOut.bind(this,o)},"Activar")):this.state.outs[o]==1&&(n="greenCircle",r=React.createElement("button",{className:"disable",type:"button",onClick:this.disableOut.bind(this,o)},"Desactivar")),t.push(React.createElement("div",{className:"output",key:13*o},React.createElement("h2",null,s),React.createElement("div",{className:n}),r));return React.createElement("div",null,t)}});React.render(React.createElement(t,null),e)}).call(this);
